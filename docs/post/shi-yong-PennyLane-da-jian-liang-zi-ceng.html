<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark_dimmed" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />
    <link rel="preconnect" href="https://code.buxiantang.top"><link rel="preconnect" href="https://blog.meekdai.com"><link rel="stylesheet" href="https://code.buxiantang.top/assets/GmeekBaseTheme.css"><script>if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',function(){var s=document.createElement('script');s.src='https://code.buxiantang.top/assets/GmeekCustomizeCss.js';document.head.appendChild(s);})}else{var s=document.createElement('script');s.src='https://code.buxiantang.top/assets/GmeekCustomizeCss.js';document.head.appendChild(s)}</script><script src="https://blog.meekdai.com/assets/GmeekVercount.js"></script><script type="text/javascript">(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window,document,"clarity","script","na4qnk47pl");</script>
    <link rel="icon" href="https://avatars.githubusercontent.com/u/172103124?s=400&u=b7a8945af2f0859ce28b8e3895a5e3acb62de8b5&v=4"><script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
<meta name="description" content="[PennyLane](https://pennylane.ai/qml) æ˜¯ä¸€ä¸ªå°†é‡å­è®¡ç®—ä¸æœºå™¨å­¦ä¹ èåˆçš„å¼€æºåº“ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯é€šè¿‡å¯å¾®åˆ†é‡å­ç”µè·¯æ— ç¼é›†æˆç»å…¸ä¸é‡å­è®¡ç®—ï¼Œå…¶å¯¹é‡å­è®¾å¤‡å’Œç»å…¸è®¾å¤‡å…¼å®¹æ€§è¾ƒå¥½ï¼ŒåŒæ—¶å…¼å®¹pytorchã€‚">
<meta property="og:title" content="ä½¿ç”¨PennyLaneæ­å»ºé‡å­å±‚">
<meta property="og:description" content="[PennyLane](https://pennylane.ai/qml) æ˜¯ä¸€ä¸ªå°†é‡å­è®¡ç®—ä¸æœºå™¨å­¦ä¹ èåˆçš„å¼€æºåº“ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯é€šè¿‡å¯å¾®åˆ†é‡å­ç”µè·¯æ— ç¼é›†æˆç»å…¸ä¸é‡å­è®¡ç®—ï¼Œå…¶å¯¹é‡å­è®¾å¤‡å’Œç»å…¸è®¾å¤‡å…¼å®¹æ€§è¾ƒå¥½ï¼ŒåŒæ—¶å…¼å®¹pytorchã€‚">
<meta property="og:type" content="article">
<meta property="og:url" content="https://Tundy-04.github.io/Tundy-04/post/shi-yong-PennyLane-da-jian-liang-zi-ceng.html">
<meta property="og:image" content="https://avatars.githubusercontent.com/u/172103124?s=400&u=b7a8945af2f0859ce28b8e3895a5e3acb62de8b5&v=4">
<title>ä½¿ç”¨PennyLaneæ­å»ºé‡å­å±‚</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />


</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">ä½¿ç”¨PennyLaneæ­å»ºé‡å­å±‚</h1>
<div class="title-right">
    <a href="https://Tundy-04.github.io/Tundy-04" id="buttonHome" class="btn btn-invisible circle" title="é¦–é¡µ">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/Tundy-04/Tundy-04/issues/9" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="åˆ‡æ¢ä¸»é¢˜">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><p><a href="https://pennylane.ai/qml" rel="nofollow">PennyLane</a> æ˜¯ä¸€ä¸ªå°†é‡å­è®¡ç®—ä¸æœºå™¨å­¦ä¹ èåˆçš„å¼€æºåº“ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯é€šè¿‡å¯å¾®åˆ†é‡å­ç”µè·¯æ— ç¼é›†æˆç»å…¸ä¸é‡å­è®¡ç®—ï¼Œå…¶å¯¹é‡å­è®¾å¤‡å’Œç»å…¸è®¾å¤‡å…¼å®¹æ€§è¾ƒå¥½ï¼ŒåŒæ—¶å…¼å®¹pytorchã€‚ä¸‹é¢æˆ‘ä»¬è¯¦ç»†è§£æå¦‚ä½•ä½¿ç”¨ QNodeæ­å»ºé‡å­çº¿è·¯ã€å¸¸ç”¨çš„é‡å­é—¨å‡½æ•°ã€å¯è§†åŒ–æ–¹æ³•ï¼Œä»¥åŠå’Œpytorchçš„modelä¸­ä½œä¸ºä¸€ä¸ªå±‚çš„æ¥è½¨å’Œè®­ç»ƒã€‚</p>
<h1>1.é‡å­çº¿è·¯æ­å»º</h1>
<p>è¿™é‡Œä»‹ç»å¦‚ä½•æ­å»ºä¸€ä¸ªé‡å­çº¿è·¯ï¼ŒåŒ…æ‹¬é™æ€çš„å’ŒåŠ¨æ€çš„ï¼ˆPQCï¼‰ï¼Œå¯ä»¥å¹¿æ³›ç”¨äºé‡å­è®¡ç®—ç›¸å…³ä»£ç å®ç°ï¼ŒåŒ…æ‹¬é‡å­ç®—æ³•ï¼Œé‡å­æœºå™¨å­¦ä¹ ç­‰ã€‚</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">import</span> <span class="pl-s1">pennylane</span> <span class="pl-k">as</span> <span class="pl-s1">qml</span></pre></div>
<p>ä¸€èˆ¬åº“çš„ç¼©å†™æ˜¯åå­—æˆ–ç”¨é€”çš„ç¼©å†™ï¼Œè¿™é‡Œç¼©å†™ä¹ æƒ¯ç”¨qmlï¼ˆé‡å­æœºå™¨å­¦ä¹ ï¼‰</p>
<h2>1.1 åŸºæœ¬ç»“æ„</h2>
<p>âš›ï¸ QNodeï¼šé‡å­è®¡ç®—çš„æ ¸å¿ƒå•å…ƒ</p>
<p>QNodeæ˜¯ PennyLane çš„æ ¸å¿ƒæŠ½è±¡ï¼Œå®ƒå°†é‡å­å‡½æ•°ï¼ˆåŒ…å«é‡å­æ“ä½œçš„ Python å‡½æ•°ï¼‰è½¬æ¢ä¸ºå¯åœ¨é‡å­è®¾å¤‡ï¼ˆæ¨¡æ‹Ÿå™¨æˆ–çœŸå®ç¡¬ä»¶ï¼‰ä¸Šæ‰§è¡Œçš„å¯¹è±¡ï¼Œå¹¶ç¡®ä¿å…¶å¯å¾®æ€§ï¼Œä»¥æ”¯æŒæ¢¯åº¦è®¡ç®—å’Œä¼˜åŒ–ã€‚</p>
<p>æ„å»ºä¸€ä¸ªåŸºæœ¬çš„ QNodeåŒ…å«ä¸‰ä¸ªå…³é”®æ­¥éª¤ï¼š</p>
<ul>
<li><strong>å®šä¹‰é‡å­è®¾å¤‡</strong>ï¼šæŒ‡å®šè¿è¡Œé‡å­çº¿è·¯çš„åç«¯ã€‚</li>
</ul>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">import</span> <span class="pl-s1">pennylane</span> <span class="pl-k">as</span> <span class="pl-s1">qml</span>
<span class="pl-c"># åˆ›å»ºä¸€ä¸ªä½¿ç”¨ 2 ä¸ªé‡å­æ¯”ç‰¹çš„é»˜è®¤é‡å­æ¨¡æ‹Ÿå™¨</span>
<span class="pl-s1">dev</span> <span class="pl-c1">=</span> <span class="pl-s1">qml</span>.<span class="pl-c1">device</span>(<span class="pl-s">"default.qubit"</span>, <span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-c1">2</span>)</pre></div>
<p>è¿™é‡Œçš„ wireså‚æ•°å®šä¹‰äº†å¯ç”¨çš„é‡å­æ¯”ç‰¹æ•°é‡(çº¿è·¯æ•°ç›®)</p>
<ul>
<li><strong>ä½¿ç”¨ @qml.qnodeè£…é¥°å™¨</strong>ï¼šå°†ç»å…¸çš„ Python å‡½æ•°è½¬æ¢ä¸ºé‡å­èŠ‚ç‚¹ã€‚</li>
</ul>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-en">@<span class="pl-s1">qml</span>.<span class="pl-c1">qnode</span>(<span class="pl-s1">dev</span>)  <span class="pl-c"># å°† quantum_circuit å‡½æ•°ç»‘å®šåˆ°è®¾å¤‡ dev</span></span>
<span class="pl-k">def</span> <span class="pl-en">quantum_circuit</span>(<span class="pl-s1">x</span>):
    <span class="pl-c"># é‡å­æ“ä½œå°†åœ¨è¿™é‡Œå®šä¹‰</span>
    ...
    <span class="pl-k">return</span> ...  <span class="pl-c"># è¿”å›æµ‹é‡ç»“æœ</span></pre></div>
<ul>
<li><strong>åœ¨å‡½æ•°å†…å®šä¹‰é‡å­çº¿è·¯</strong>ï¼šåœ¨è¢«è£…é¥°çš„å‡½æ•°ä¸­ï¼Œé€šè¿‡æ·»åŠ é‡å­é—¨æ“ä½œæ¥æ„å»ºçº¿è·¯ï¼Œå¹¶æœ€ç»ˆè¿”å›ä¸€ä¸ªæµ‹é‡å€¼ã€‚</li>
</ul>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-en">@<span class="pl-s1">qml</span>.<span class="pl-c1">qnode</span>(<span class="pl-s1">dev</span>)</span>
<span class="pl-k">def</span> <span class="pl-en">quantum_circuit</span>(<span class="pl-s1">x</span>):
    <span class="pl-s1">qml</span>.<span class="pl-c1">Hadamard</span>(<span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-c1">0</span>)       <span class="pl-c"># å¯¹ç¬¬0ä¸ªé‡å­æ¯”ç‰¹åº”ç”¨Hé—¨ï¼Œåˆ›å»ºå åŠ æ€</span>
    <span class="pl-s1">qml</span>.<span class="pl-c1">RY</span>(<span class="pl-s1">x</span>, <span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-c1">0</span>)          <span class="pl-c"># ä½¿ç”¨å‚æ•° x è¿›è¡ŒYè½´æ—‹è½¬</span>
    <span class="pl-s1">qml</span>.<span class="pl-c1">CNOT</span>(<span class="pl-s1">wires</span><span class="pl-c1">=</span>[<span class="pl-c1">0</span>, <span class="pl-c1">1</span>])      <span class="pl-c"># åœ¨é‡å­æ¯”ç‰¹0å’Œ1ä¹‹é—´åº”ç”¨CNOTé—¨ï¼Œç”Ÿæˆçº ç¼ </span>
    <span class="pl-k">return</span> <span class="pl-s1">qml</span>.<span class="pl-c1">expval</span>(<span class="pl-s1">qml</span>.<span class="pl-c1">PauliZ</span>(<span class="pl-c1">0</span>))  <span class="pl-c"># è¿”å›ç¬¬ä¸€ä¸ªé‡å­æ¯”ç‰¹çš„Pauli-ZæœŸæœ›å€¼</span></pre></div>
<p>æ‰§è¡Œæ­¤å‡½æ•°ï¼ˆå¦‚ result = quantum_circuit(0.5)ï¼‰ä¼šåœ¨æŒ‡å®šçš„è®¾å¤‡ä¸Šè¿è¡Œçº¿è·¯å¹¶è¿”å›æµ‹é‡ç»“æœ</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://github.com/user-attachments/assets/4a671b06-9900-4c72-923c-1105a4cbc027"><img width="1387" height="1820" alt="Image" src="https://github.com/user-attachments/assets/4a671b06-9900-4c72-923c-1105a4cbc027" style="max-width: 100%; height: auto; max-height: 1820px;"></a></p>
<h2>1.2 æµ‹é‡çº¿è·¯</h2>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>æµ‹é‡ç±»å‹(QNodeè¿”å›)</th>
<th>å‡½æ•°</th>
<th>è¾“å‡ºå«ä¹‰</th>
<th>ç»å…¸ç±»æ¯”(è¿‘ä¼¼ç†è§£)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æœŸæœ›å€¼</strong></td>
<td><code class="notranslate">qml.expval(Observable)</code></td>
<td>å¯¹æŸä¸ªå¯è§‚æµ‹é‡ï¼ˆå¦‚è‡ªæ—‹æ–¹å‘ï¼‰çš„å¹³å‡å€¼ã€‚</td>
<td>é¢„æµ‹ä¸€ä¸ªéšæœºå˜é‡çš„<strong>å¹³å‡å€¼</strong>ã€‚</td>
</tr>
<tr>
<td><strong>æ¦‚ç‡</strong></td>
<td><code class="notranslate">qml.probs(wires)</code></td>
<td>æµ‹é‡å¾—åˆ°æ¯ä¸ªè®¡ç®—åŸºæ€çš„æ¦‚ç‡ã€‚</td>
<td>ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œå¦‚ <code class="notranslate">[0.7, 0.3]</code>ã€‚</td>
</tr>
<tr>
<td><strong>æ ·æœ¬</strong></td>
<td><code class="notranslate">qml.sample(Observable)</code></td>
<td>å¯¹å¯è§‚æµ‹é‡è¿›è¡Œå¤šæ¬¡é‡å¤æµ‹é‡ï¼Œå¾—åˆ°å…·ä½“ç»“æœã€‚</td>
<td>æ·éª°å­Næ¬¡ï¼Œè®°å½•æ¯æ¬¡çš„ç‚¹æ•°ã€‚</td>
</tr>
<tr>
<td><strong>é‡å­æ€</strong></td>
<td><code class="notranslate">qml.state()</code></td>
<td>ç›´æ¥è·å–æ¨¡æ‹Ÿçš„é‡å­æ€å‘é‡ï¼ˆä»…ä»¿çœŸå™¨å¯ç”¨ï¼‰ã€‚</td>
<td>è·å–ä¸€ä¸ªéšæœºè¿‡ç¨‹çš„å®Œæ•´æ¦‚ç‡å¹…ã€‚</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p>ğŸ”¬éœ€è¦è¯´æ˜çš„æ˜¯ï¼šç›´æ¥è·å–æ¨¡æ‹Ÿçš„é‡å­æ€å‘é‡ï¼Œèƒ½ä¸ç”¨å°±å°½é‡ä¸ç”¨ï¼Œæ¯•ç«Ÿé‡å­è®¡ç®—ç ”ç©¶çš„ç›®çš„æœ€åæ˜¯åº”ç”¨åœ¨çœŸå®çš„é‡å­ç¡¬ä»¶ä¸Šçš„ã€‚é‡å­æ€ä¼šåœ¨æµ‹é‡ååç¼©ï¼Œè¿™æ˜¯ä¸å¯é€†çš„ï¼Œå¦‚æœæƒ³çŸ¥é“æŸä¸ªå…·ä½“çš„é‡å­æ€ï¼Œæµ‹é‡åå®ƒå°±å¤±å»æ„ä¹‰äº†ã€‚è€Œæ ¹æ®ä¸å¯å…‹éš†å®šç†ï¼Œä½ æ²¡æ³•é€šè¿‡ç®€å•çš„å¼€é”€ï¼ˆéœ€è¦é¢å¤–çš„è¾…åŠ©qubitï¼‰å°±é€ å‡ºä¸€ä¸ªä¸€æ ·çš„é‡å­æ€æ¥ã€‚ä»¿çœŸä¸­ä½ å½“ç„¶å¯ä»¥ç›´æ¥è·å–æŸä¸ªqubitçš„å¯†åº¦çŸ©é˜µæ¥å¤åˆ¶å®ƒå’Œæµ‹é‡å®ƒï¼Œä½†åœ¨çœŸå®ç¡¬ä»¶ä¸­æ²¡æ³•è¿™ä¹ˆåšï¼Œå±äºæ˜¯â€œä½œå¼Šâ€è¡Œä¸ºã€‚</p>
<h2>1.3 é‡å­é—¨å‡½æ•°</h2>
<p>é‡å­é—¨æ˜¯æ“æ§é‡å­æ€çš„åŸºæœ¬å•å…ƒã€‚PennyLane æä¾›äº†ä¸°å¯Œçš„é—¨å‡½æ•°ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æ ¸å¿ƒç±»åˆ«ï¼š</p>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>é—¨ç±»å‹</th>
<th>å‡½æ•°ç¤ºä¾‹</th>
<th>åŠŸèƒ½æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>Paulié—¨</td>
<td><code class="notranslate">qml.PauliX(wires=i)</code></td>
<td>æ¯”ç‰¹ç¿»è½¬ï¼ˆç»•Xè½´æ—‹è½¬Ï€ï¼‰</td>
</tr>
<tr>
<td></td>
<td><code class="notranslate">qml.PauliY(wires=i)</code></td>
<td>ç»•Yè½´æ—‹è½¬Ï€</td>
</tr>
<tr>
<td></td>
<td><code class="notranslate">qml.PauliZ(wires=i)</code></td>
<td>ç›¸ä½ç¿»è½¬ï¼ˆç»•Zè½´æ—‹è½¬Ï€ï¼‰</td>
</tr>
<tr>
<td>æ—‹è½¬é—¨</td>
<td><code class="notranslate">qml.RX(phi, wires=i)</code></td>
<td>ç»•Xè½´æ—‹è½¬è§’åº¦Ï†</td>
</tr>
<tr>
<td></td>
<td><code class="notranslate">qml.RY(phi, wires=i)</code></td>
<td>ç»•Yè½´æ—‹è½¬è§’åº¦Ï†</td>
</tr>
<tr>
<td></td>
<td><code class="notranslate">qml.RZ(phi, wires=i)</code></td>
<td>ç»•Zè½´æ—‹è½¬è§’åº¦Ï†</td>
</tr>
<tr>
<td>é€šç”¨é—¨</td>
<td><code class="notranslate">qml.Hadamard(wires=i)</code></td>
<td>åˆ›å»ºå åŠ æ€: |0âŸ© â†’ (|0âŸ©+|1âŸ©)/âˆš2</td>
</tr>
<tr>
<td></td>
<td><code class="notranslate">qml.CNOT(wires=[c, t])</code></td>
<td>å—æ§éé—¨ï¼šæ§åˆ¶æ¯”ç‰¹cä¸º1æ—¶ç¿»è½¬ç›®æ ‡æ¯”ç‰¹t</td>
</tr>
<tr>
<td>ç‰¹æ®Šé—¨</td>
<td><code class="notranslate">qml.Rot(a, b, c, wires=i)</code></td>
<td>ä¾æ¬¡è¿›è¡ŒRZ(b)ã€RY(a)ã€RZ(c)æ—‹è½¬ï¼Œç”¨äºå®ç°ä»»æ„å•æ¯”ç‰¹é…‰å˜æ¢ ã€‚</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p>å¤šé‡å­æ¯”ç‰¹é—¨ï¼ˆå¦‚ CNOTï¼‰æ˜¯äº§ç”Ÿé‡å­çº ç¼ çš„å…³é”®ã€‚æ‰€æœ‰è¿™äº›é—¨æ“ä½œéƒ½æŒ‰å…¶åœ¨å‡½æ•°ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡æ‰§è¡Œ</p>
<h2>1.4 çº¿è·¯å¯è§†åŒ–</h2>
<p>ğŸ“ é‡å­çº¿è·¯å¯è§†åŒ–</p>
<p>æ¸…æ™°åœ°æŸ¥çœ‹çº¿è·¯ç»“æ„å¯¹äºç†è§£å’Œè°ƒè¯•è‡³å…³é‡è¦ã€‚PennyLane æä¾›äº†ä¾¿æ·çš„å¯è§†åŒ–å·¥å…·ã€‚</p>
<ul>
<li>åŸºç¡€æ–‡æœ¬å¯è§†åŒ–ï¼šä½¿ç”¨ qml.draw()å‡½æ•°å¯ä»¥ç”Ÿæˆçº¿è·¯çš„æ–‡æœ¬å›¾ã€‚</li>
</ul>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-c"># æ¥ä¸Šé¢çš„ä»£ç </span>
<span class="pl-s1">drawn_circuit</span> <span class="pl-c1">=</span> <span class="pl-s1">qml</span>.<span class="pl-c1">draw</span>(<span class="pl-s1">quantum_circuit</span>)(<span class="pl-c1">0.5</span>)
<span class="pl-en">print</span>(<span class="pl-s1">drawn_circuit</span>)</pre></div>
<ul>
<li>é«˜çº§ç»˜å›¾åŠŸèƒ½ï¼šå¯¹äºæ›´å¤æ‚çš„çº¿è·¯ï¼Œå¯ä»¥ä½¿ç”¨ qml.draw_mplå‡½æ•°ç”Ÿæˆæ›´ç²¾ç¾çš„ matplotlib å›¾åƒã€‚</li>
</ul>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-s1">fig</span>, <span class="pl-s1">ax</span> <span class="pl-c1">=</span> <span class="pl-s1">qml</span>.<span class="pl-c1">draw_mpl</span>(<span class="pl-s1">quantum_circuit</span>, <span class="pl-s1">decimals</span><span class="pl-c1">=</span><span class="pl-c1">2</span>)(<span class="pl-c1">0.5</span>)
<span class="pl-s1">plt</span>.<span class="pl-c1">show</span>()</pre></div>
<h2>1.5 ç¤ºä¾‹</h2>
<p>ä»¥ä¸‹æ˜¯ä¸€æ®µé‡å­çº¿è·¯å®ç°å’Œå¯è§†åŒ–çš„å®Œæ•´ç¤ºä¾‹ï¼š</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-c"># 1. å®šä¹‰é‡å­è®¾å¤‡ï¼ˆä½¿ç”¨é»˜è®¤çš„æ¨¡æ‹Ÿå™¨ï¼‰</span>
<span class="pl-s1">dev</span> <span class="pl-c1">=</span> <span class="pl-s1">qml</span>.<span class="pl-c1">device</span>(<span class="pl-s">"default.qubit"</span>, <span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-c1">2</span>)

<span class="pl-c"># 2. åˆ›å»ºé‡å­èŠ‚ç‚¹ï¼Œå¹¶æŒ‡å®šä½¿ç”¨PyTorchæ¥å£</span>
<span class="pl-en">@<span class="pl-s1">qml</span>.<span class="pl-c1">qnode</span>(<span class="pl-s1">dev</span>, <span class="pl-s1">interface</span><span class="pl-c1">=</span><span class="pl-s">"torch"</span>)</span>
<span class="pl-k">def</span> <span class="pl-en">circuit</span>(<span class="pl-s1">params</span>):
    <span class="pl-s1">qml</span>.<span class="pl-c1">RX</span>(<span class="pl-s1">params</span>[<span class="pl-c1">0</span>], <span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-c1">0</span>)  <span class="pl-c"># ç”¨å‚æ•°params[0]è¿›è¡ŒXæ—‹è½¬</span>
    <span class="pl-s1">qml</span>.<span class="pl-c1">RY</span>(<span class="pl-s1">params</span>[<span class="pl-c1">1</span>], <span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-c1">1</span>)  <span class="pl-c"># ç”¨å‚æ•°params[1]è¿›è¡ŒYæ—‹è½¬</span>
    <span class="pl-s1">qml</span>.<span class="pl-c1">CNOT</span>(<span class="pl-s1">wires</span><span class="pl-c1">=</span>[<span class="pl-c1">0</span>, <span class="pl-c1">1</span>])      <span class="pl-c"># æ·»åŠ ä¸€ä¸ªCNOTé—¨</span>
    <span class="pl-k">return</span> <span class="pl-s1">qml</span>.<span class="pl-c1">expval</span>(<span class="pl-s1">qml</span>.<span class="pl-c1">PauliZ</span>(<span class="pl-c1">0</span>))  <span class="pl-c"># è¿”å›é‡å­æ¯”ç‰¹0ä¸ŠPauli Zç®—ç¬¦çš„æœŸæœ›å€¼</span>

<span class="pl-c"># 3. å¯è§†åŒ–</span>
<span class="pl-en">print</span>(<span class="pl-s">"<span class="pl-cce">\n</span>=== é‡å­çº¿è·¯å›¾å½¢å¯è§†åŒ– ==="</span>)
<span class="pl-k">try</span>:
    <span class="pl-c"># ä½¿ç”¨qml.draw_mpl()ç”Ÿæˆå›¾å½¢åŒ–ç”µè·¯å›¾[1,6](@ref)</span>
    <span class="pl-c"># ä½¿ç”¨Windowsç³»ç»Ÿè‡ªå¸¦çš„å¾®è½¯é›…é»‘ï¼ˆé€‚ç”¨äºWindowsç”¨æˆ·ï¼‰</span>
    <span class="pl-s1">plt</span>.<span class="pl-c1">rcParams</span>[<span class="pl-s">'font.sans-serif'</span>] <span class="pl-c1">=</span> [<span class="pl-s">'Microsoft YaHei'</span>]  <span class="pl-c"># æˆ– ['SimHei'] å¯¹åº”é»‘ä½“</span>
    <span class="pl-s1">fig</span>, <span class="pl-s1">ax</span> <span class="pl-c1">=</span> <span class="pl-s1">qml</span>.<span class="pl-c1">draw_mpl</span>(<span class="pl-s1">circuit</span>)(<span class="pl-s1">params</span>)
    <span class="pl-s1">plt</span>.<span class="pl-c1">title</span>(<span class="pl-s">"å‚æ•°åŒ–é‡å­ç”µè·¯å¯è§†åŒ–"</span>)
    <span class="pl-s1">plt</span>.<span class="pl-c1">tight_layout</span>()
    <span class="pl-s1">plt</span>.<span class="pl-c1">show</span>()
    <span class="pl-en">print</span>(<span class="pl-s">"å›¾å½¢å¯è§†åŒ–å·²æ˜¾ç¤ºï¼Œå…³é—­çª—å£ç»§ç»­æ‰§è¡Œ..."</span>)
<span class="pl-k">except</span> <span class="pl-v">Exception</span> <span class="pl-k">as</span> <span class="pl-s1">e</span>:
    <span class="pl-en">print</span>(<span class="pl-s">f"å›¾å½¢å¯è§†åŒ–å¤±è´¥: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">e</span><span class="pl-kos">}</span></span>"</span>)
    <span class="pl-en">print</span>(<span class="pl-s">"è¯·ç¡®ä¿å·²å®‰è£…matplotlib: pip install matplotlib"</span>)</pre></div>
<p>è¾“å‡ºï¼š</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://github.com/user-attachments/assets/e59ec9e3-db03-48fa-a5b9-778da823514d"><img width="519" height="342" alt="Image" src="https://github.com/user-attachments/assets/e59ec9e3-db03-48fa-a5b9-778da823514d" style="max-width: 100%; height: auto; max-height: 342px;"></a></p>
<h1>2.æ­å»ºé‡å­å±‚</h1>
<p>æ­å»ºé‡å­å±‚ï¼ˆéšæœºé™æ€/PQCï¼‰çš„é€»è¾‘æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://github.com/user-attachments/assets/93acf066-ada4-42a5-9deb-6f8d82178831"><img width="2000" height="1964" alt="Image" src="https://github.com/user-attachments/assets/93acf066-ada4-42a5-9deb-6f8d82178831" style="max-width: 100%; height: auto; max-height: 1964px;"></a></p>
<h2>2.1 åŒºåˆ«ä¸é€‰æ‹©</h2>
<p>ç†è§£å¯è®­ç»ƒçš„å‚æ•°åŒ–é‡å­ç”µè·¯ï¼ˆPQCï¼‰å’Œé™æ€é‡å­çº¿è·¯çš„åŒºåˆ«ï¼Œæ˜¯æŒæ¡é‡å­æœºå™¨å­¦ä¹ çš„å…³é”®ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼èƒ½å¸®ä½ å¿«é€ŸæŠ“ä½å®ƒä»¬çš„æ ¸å¿ƒä¸åŒã€‚</p>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>ç‰¹æ€§ç»´åº¦</th>
<th>å‚æ•°åŒ–é‡å­ç”µè·¯(PQC)</th>
<th>é™æ€é‡å­çº¿è·¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ ¸å¿ƒå‚æ•°</td>
<td>åŒ…å«å¯è®­ç»ƒçš„å‚æ•°ï¼ˆå¦‚æ—‹è½¬é—¨è§’åº¦Î¸ï¼‰</td>
<td>ç”±å›ºå®šçš„é‡å­é—¨åºåˆ—ç»„æˆï¼Œæ— è®­ç»ƒå‚æ•°</td>
</tr>
<tr>
<td>è®¾è®¡ç›®æ ‡</td>
<td>å¯»æ±‚æœ€ä¼˜è§£ï¼Œé€šè¿‡è®­ç»ƒè°ƒæ•´å‚æ•°ä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°</td>
<td>æ‰§è¡Œç¡®å®šè¿ç®—ï¼Œå®ç°è®¾è®¡å¥½çš„ç‰¹å®šé‡å­é€»è¾‘</td>
</tr>
<tr>
<td>ä¸ç»å…¸ç³»ç»Ÿäº¤äº’</td>
<td>æ·±åº¦è€¦åˆï¼Œæ„æˆé‡å­-ç»å…¸æ··åˆè®¡ç®—é—­ç¯çš„ä¸€éƒ¨åˆ†</td>
<td>å¼±äº¤äº’ï¼Œé€šå¸¸ä¸€æ¬¡æ€§è¾“å…¥ç»å…¸æ•°æ®å¹¶è¾“å‡ºç»“æœ</td>
</tr>
<tr>
<td>æµ‹é‡è¾“å‡º</td>
<td>æµ‹é‡ç»“æœï¼ˆå¦‚æœŸæœ›å€¼ï¼‰ç”¨äºè®¡ç®—æŸå¤±å‡½æ•°ï¼Œå¹¶æŒ‡å¯¼å‚æ•°æ›´æ–°</td>
<td>æµ‹é‡ç»“æœå³ä¸ºè®¡ç®—çš„æœ€ç»ˆç­”æ¡ˆ</td>
</tr>
<tr>
<td>å…¸å‹åº”ç”¨</td>
<td>é‡å­æœºå™¨å­¦ä¹ ã€å˜åˆ†é‡å­ç®—æ³•ï¼ˆVQE, QAOAï¼‰</td>
<td>é‡å­å‚…é‡Œå¶å˜æ¢ã€Groveræœç´¢ç®—æ³•ç­‰</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p>ğŸ§  å¯è®­ç»ƒPQCçš„è¿ä½œæ–¹å¼</p>
<p>PQCçš„å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒå’Œç»å…¸æœºå™¨å­¦ä¹ æµç¨‹çš„æ— ç¼èåˆã€‚</p>
<p>ç”µè·¯æ„å»ºï¼šé¦–å…ˆï¼Œä½ éœ€è¦è®¾è®¡ä¸€ä¸ªçº¿è·¯æ¶æ„ï¼ˆAnsatzï¼‰ã€‚è¿™ä¸ªæ¶æ„ä¸­åŒ…å«äº†ä¸€äº›ç”±å‚æ•°æ§åˆ¶çš„é‡å­é—¨ï¼Œæœ€å¸¸è§çš„æ˜¯å•é‡å­æ¯”ç‰¹æ—‹è½¬é—¨ï¼ˆå¦‚ RX(Î¸), RY(Î¸), RZ(Î¸)ï¼‰ï¼Œå…¶ä¸­çš„è§’åº¦ Î¸å°±æ˜¯å¯è®­ç»ƒçš„å‚æ•°ã€‚</p>
<p>æ··åˆè®¡ç®—é—­ç¯ï¼šPQCçš„è¿ä½œæ˜¯ä¸€ä¸ªå…¸å‹çš„â€œé‡å­-ç»å…¸æ··åˆâ€è¿‡ç¨‹ï¼š</p>
<ul>
<li>ç»å…¸ä¾§ï¼šåˆå§‹åŒ–å‚æ•°ï¼Œå°†å‚æ•° Î¸å’Œè¾“å…¥æ•°æ®ï¼ˆé€šè¿‡ç‰¹å®šç¼–ç æ–¹å¼æ³¨å…¥é‡å­æ€ï¼‰ä¼ ç»™é‡å­è®¾å¤‡ã€‚</li>
<li>é‡å­ä¾§ï¼šåœ¨é‡å­è®¾å¤‡ä¸Šè¿è¡ŒPQCï¼Œå¹¶è¿›è¡Œæµ‹é‡ï¼Œå¾—åˆ°æœŸæœ›å€¼ç­‰ç»“æœã€‚</li>
<li>ç»å…¸ä¾§ï¼šæ ¹æ®æµ‹é‡ç»“æœè®¡ç®—æŸå¤±å‡½æ•°ï¼Œç„¶ååˆ©ç”¨ç»å…¸ä¼˜åŒ–å™¨ï¼ˆå¦‚æ¢¯åº¦ä¸‹é™ï¼‰æ ¹æ®æ¢¯åº¦ä¿¡æ¯æ›´æ–°å‚æ•° Î¸ã€‚è¿™ä¸ªå¾ªç¯ä¼šæŒç»­è¿›è¡Œï¼Œç›´åˆ°æ¨¡å‹æ”¶æ•›ã€‚</li>
</ul>
<p>åœ¨PennyLaneä¸­ï¼Œ@qml.qnodeè£…é¥°å™¨å°è£…äº†é‡å­è®¡ç®—éƒ¨åˆ†ï¼Œè€Œè‡ªåŠ¨å¾®åˆ†åŠŸèƒ½ä½¿å¾—è®¡ç®—è¿™äº›æ¢¯åº¦å˜å¾—éå¸¸ç®€å•ã€‚</p>
<p>âš™ï¸ é™æ€çº¿è·¯çš„ç¡®å®šæ€§é€»è¾‘</p>
<p>é™æ€çº¿è·¯çš„è®¾è®¡å’Œè¿è¡Œé€»è¾‘ä¸PQCæœ‰æœ¬è´¨åŒºåˆ«ã€‚</p>
<p>å›ºå®šæµç¨‹ï¼šé™æ€çº¿è·¯çš„é—¨åºåˆ—å’Œæ‰€æœ‰å‚æ•°åœ¨æ„å»ºæ—¶å°±å·²ç»å®Œå…¨ç¡®å®šã€‚æ¯æ¬¡è¿è¡ŒåŒä¸€çº¿è·¯ï¼Œåªè¦è¾“å…¥ç›¸åŒï¼Œå¾—åˆ°çš„è¾“å‡ºåœ¨æ¦‚ç‡åˆ†å¸ƒä¸Šå°±æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>æ ¸å¿ƒåœ¨äºè®¾è®¡ï¼šå¯¹äºé™æ€çº¿è·¯ï¼Œå·¥ä½œçš„é‡ç‚¹åœ¨äºè®¾è®¡å‡ºæ­£ç¡®çš„é—¨åºåˆ—æ¥å®ç°ç‰¹å®šç®—æ³•ï¼Œä¾‹å¦‚åœ¨é‡å­å‚…é‡Œå¶å˜æ¢ä¸­ç²¾ç¡®å®‰æ’å—æ§é—¨çš„ä½ç½®å’Œç›¸ä½æ—‹è½¬é—¨çš„è§’åº¦ã€‚</p>
<p>ğŸ’¡ å¦‚ä½•é€‰æ‹©ï¼Ÿ</p>
<p>é€‰æ‹©PQCï¼šå½“ä½ é¢å¯¹çš„é—®é¢˜æ²¡æœ‰å·²çŸ¥çš„é«˜æ•ˆé‡å­ç®—æ³•ï¼Œæˆ–è€…éœ€è¦åœ¨å«å™ªå£°çš„ä¸­ç­‰è§„æ¨¡é‡å­ï¼ˆNISQï¼‰è®¾å¤‡ä¸Šè§£å†³ä¼˜åŒ–ã€æœºå™¨å­¦ä¹ ä»»åŠ¡æ—¶ï¼ŒPQCå’Œå˜åˆ†é‡å­ç®—æ³•æ˜¯é¦–é€‰ã€‚</p>
<p>é€‰æ‹©é™æ€çº¿è·¯ï¼šå½“ä½ éœ€è¦æ‰§è¡Œå·²è¢«ä¸¥æ ¼è¯æ˜å…·æœ‰é‡å­ä¼˜åŠ¿çš„ç®—æ³•ï¼ˆå¦‚Shorç®—æ³•ã€Groverç®—æ³•ï¼‰æ—¶ï¼Œé™æ€çº¿è·¯æ˜¯å®ç°è¿™äº›ç®—æ³•çš„æ ‡å‡†æ–¹å¼ã€‚</p>
<h2>2.2 æ­å»ºé™æ€ä¸åŠ¨æ€é‡å­å±‚</h2>
<p>ğŸ’» ä»£ç å®ç°è¯¦è§£</p>
<p>ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹åœ¨PyTorchå’ŒPennyLaneçš„æ··åˆæ¨¡å‹ä¸­ï¼Œè¿™ä¸¤ç§çº¿è·¯å¦‚ä½•å…·ä½“å®ç°ã€‚</p>
<h3>å…¬å…±è®¾ç½®</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¼å…¥å¿…è¦çš„åº“å¹¶å®šä¹‰ä¸€äº›å…¬å…±å‚æ•°ã€‚</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-k">import</span> <span class="pl-s1">torch</span>
<span class="pl-k">import</span> <span class="pl-s1">torch</span>.<span class="pl-s1">nn</span> <span class="pl-k">as</span> <span class="pl-s1">nn</span>
<span class="pl-k">import</span> <span class="pl-s1">pennylane</span> <span class="pl-k">as</span> <span class="pl-s1">qml</span>
<span class="pl-k">import</span> <span class="pl-s1">numpy</span> <span class="pl-k">as</span> <span class="pl-s1">np</span>

<span class="pl-c"># å®šä¹‰é‡å­è®¾å¤‡</span>
<span class="pl-s1">n_qubits</span> <span class="pl-c1">=</span> <span class="pl-c1">4</span>
<span class="pl-s1">dev</span> <span class="pl-c1">=</span> <span class="pl-s1">qml</span>.<span class="pl-c1">device</span>(<span class="pl-s">"default.qubit"</span>, <span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-s1">n_qubits</span>)

<span class="pl-c"># å®šä¹‰ç”¨äºæ•°æ®ç¼–ç çš„é‡å­èŠ‚ç‚¹ï¼ˆå…¬å…±éƒ¨åˆ†ï¼‰</span>
<span class="pl-en">@<span class="pl-s1">qml</span>.<span class="pl-c1">qnode</span>(<span class="pl-s1">dev</span>, <span class="pl-s1">interface</span><span class="pl-c1">=</span><span class="pl-s">"torch"</span>)</span>
<span class="pl-k">def</span> <span class="pl-en">data_encoder</span>(<span class="pl-s1">inputs</span>):
    <span class="pl-c"># å°†ç»å…¸æ•°æ®ç¼–ç åˆ°é‡å­æ€ï¼Œä¾‹å¦‚é€šè¿‡æ—‹è½¬é—¨</span>
    <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-s1">n_qubits</span>):
        <span class="pl-s1">qml</span>.<span class="pl-c1">RY</span>(<span class="pl-s1">inputs</span>[<span class="pl-s1">i</span>], <span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-s1">i</span>)  <span class="pl-c"># ä½¿ç”¨è¾“å…¥æ•°æ®çš„æ¯ä¸ªå…ƒç´ ä½œä¸ºæ—‹è½¬è§’åº¦</span>
    <span class="pl-k">return</span> <span class="pl-s1">qml</span>.<span class="pl-c1">state</span>()</pre></div>
<h3>é™æ€çº¿è·¯å®ç°</h3>
<p>é™æ€çº¿è·¯çš„å‚æ•°æ˜¯å›ºå®šçš„ï¼Œä¸å‚ä¸è®­ç»ƒã€‚</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-c"># --- é™æ€çº¿è·¯éƒ¨åˆ† ---</span>
<span class="pl-c"># å®šä¹‰ä¸€ä¸ªå›ºå®šçš„ã€ä¸è®­ç»ƒçš„å‚æ•°</span>
<span class="pl-s1">fixed_angle</span> <span class="pl-c1">=</span> <span class="pl-s1">torch</span>.<span class="pl-c1">tensor</span>([<span class="pl-s1">np</span>.<span class="pl-c1">pi</span> <span class="pl-c1">/</span> <span class="pl-c1">4</span>])  <span class="pl-c"># ä¾‹å¦‚ï¼Œå›ºå®šä¸º45åº¦</span>

<span class="pl-en">@<span class="pl-s1">qml</span>.<span class="pl-c1">qnode</span>(<span class="pl-s1">dev</span>, <span class="pl-s1">interface</span><span class="pl-c1">=</span><span class="pl-s">"torch"</span>)</span>
<span class="pl-k">def</span> <span class="pl-en">static_quantum_conv</span>(<span class="pl-s1">inputs</span>):
    <span class="pl-c"># 1. æ•°æ®ç¼–ç ï¼ˆä¸PQCå…±äº«ï¼‰</span>
    <span class="pl-en">data_encoder</span>(<span class="pl-s1">inputs</span>)
    
    <span class="pl-c"># 2. åº”ç”¨é™æ€çš„é‡å­å·ç§¯æ“ä½œ</span>
    <span class="pl-c"># ä¾‹å¦‚ï¼Œä½¿ç”¨å›ºå®šçš„è§’åº¦å’Œå›ºå®šçš„çº ç¼ ç»“æ„</span>
    <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-s1">n_qubits</span> <span class="pl-c1">-</span> <span class="pl-c1">1</span>):
        <span class="pl-s1">qml</span>.<span class="pl-c1">CNOT</span>(<span class="pl-s1">wires</span><span class="pl-c1">=</span>[<span class="pl-s1">i</span>, <span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span>])
    <span class="pl-s1">qml</span>.<span class="pl-c1">RZ</span>(<span class="pl-s1">fixed_angle</span>, <span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-s1">n_qubits</span><span class="pl-c1">-</span><span class="pl-c1">1</span>)  <span class="pl-c"># ä½¿ç”¨å›ºå®šå‚æ•°</span>
    
    <span class="pl-k">return</span> [<span class="pl-s1">qml</span>.<span class="pl-c1">expval</span>(<span class="pl-s1">qml</span>.<span class="pl-c1">PauliZ</span>(<span class="pl-s1">i</span>)) <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-s1">n_qubits</span>)]

<span class="pl-c"># å®šä¹‰åŒ…å«é™æ€é‡å­å±‚çš„PyTorchæ¨¡å‹</span>
<span class="pl-k">class</span> <span class="pl-v">QCNN_Static</span>(<span class="pl-s1">nn</span>.<span class="pl-c1">Module</span>):
    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">super</span>().<span class="pl-c1">__init__</span>()
        <span class="pl-c"># æ³¨æ„ï¼šé™æ€çº¿è·¯çš„å‚æ•°ï¼ˆå¦‚fixed_angleï¼‰ä¸æ³¨å†Œä¸ºnn.Parameter</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">classical_fc</span> <span class="pl-c1">=</span> <span class="pl-s1">nn</span>.<span class="pl-c1">Linear</span>(<span class="pl-s1">n_qubits</span>, <span class="pl-c1">1</span>)  <span class="pl-c"># åç»­ç»å…¸å±‚</span>
        
    <span class="pl-k">def</span> <span class="pl-en">forward</span>(<span class="pl-s1">self</span>, <span class="pl-s1">x</span>):
        <span class="pl-c"># é‡å­éƒ¨åˆ†ï¼šé™æ€çº¿è·¯ï¼Œæ¯æ¬¡è®¡ç®—è¡Œä¸ºä¸€è‡´</span>
        <span class="pl-s1">quantum_out</span> <span class="pl-c1">=</span> <span class="pl-s1">torch</span>.<span class="pl-c1">tensor</span>([<span class="pl-en">static_quantum_conv</span>(<span class="pl-s1">x_i</span>) <span class="pl-k">for</span> <span class="pl-s1">x_i</span> <span class="pl-c1">in</span> <span class="pl-s1">x</span>])
        <span class="pl-c"># ç»å…¸éƒ¨åˆ†</span>
        <span class="pl-s1">output</span> <span class="pl-c1">=</span> <span class="pl-s1">self</span>.<span class="pl-c1">classical_fc</span>(<span class="pl-s1">quantum_out</span>)
        <span class="pl-k">return</span> <span class="pl-s1">output</span></pre></div>
<h3>å‚æ•°åŒ–é‡å­çº¿è·¯ï¼ˆPQCï¼‰å®ç°</h3>
<p>PQCçš„æ ¸å¿ƒåœ¨äºå…¶å‚æ•°æ˜¯å¯è®­ç»ƒçš„ã€‚</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-c"># --- PQCéƒ¨åˆ† ---</span>
<span class="pl-c"># å®šä¹‰å¯è®­ç»ƒå‚æ•°çš„ç»´åº¦ï¼šå‡è®¾æœ‰2å±‚ï¼Œæ¯å±‚ä¸ºæ¯ä¸ªé‡å­æ¯”ç‰¹å‡†å¤‡ä¸€ä¸ªå‚æ•°</span>
<span class="pl-s1">depth</span> <span class="pl-c1">=</span> <span class="pl-c1">2</span>
<span class="pl-s1">quantum_weights_shape</span> <span class="pl-c1">=</span> (<span class="pl-s1">depth</span>, <span class="pl-s1">n_qubits</span>)

<span class="pl-en">@<span class="pl-s1">qml</span>.<span class="pl-c1">qnode</span>(<span class="pl-s1">dev</span>, <span class="pl-s1">interface</span><span class="pl-c1">=</span><span class="pl-s">"torch"</span>)</span>
<span class="pl-k">def</span> <span class="pl-en">pqc_quantum_conv</span>(<span class="pl-s1">inputs</span>, <span class="pl-s1">weights</span>):  <span class="pl-c"># æ³¨æ„ï¼šçº¿è·¯å‡½æ•°æ¥æ”¶æƒé‡å‚æ•°</span>
    <span class="pl-c"># 1. æ•°æ®ç¼–ç ï¼ˆä¸é™æ€çº¿è·¯å…±äº«ï¼‰</span>
    <span class="pl-en">data_encoder</span>(<span class="pl-s1">inputs</span>)
    
    <span class="pl-c"># 2. åº”ç”¨å‚æ•°åŒ–çš„é‡å­å·ç§¯æ“ä½œï¼ˆå˜åˆ†å±‚ï¼‰</span>
    <span class="pl-c"># ä½¿ç”¨å¯è®­ç»ƒçš„æƒé‡ï¼è¿™æ˜¯ä¸é™æ€çº¿è·¯æœ€æ ¹æœ¬çš„åŒºåˆ«ã€‚</span>
    <span class="pl-k">for</span> <span class="pl-s1">layer</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-s1">depth</span>):
        <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-s1">n_qubits</span>):
            <span class="pl-s1">qml</span>.<span class="pl-c1">RY</span>(<span class="pl-s1">weights</span>[<span class="pl-s1">layer</span>][<span class="pl-s1">i</span>], <span class="pl-s1">wires</span><span class="pl-c1">=</span><span class="pl-s1">i</span>)
        <span class="pl-c"># æ·»åŠ çº ç¼ ä»¥å¢åŠ å¤æ‚æ€§</span>
        <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-s1">n_qubits</span> <span class="pl-c1">-</span> <span class="pl-c1">1</span>):
            <span class="pl-s1">qml</span>.<span class="pl-c1">CNOT</span>(<span class="pl-s1">wires</span><span class="pl-c1">=</span>[<span class="pl-s1">i</span>, <span class="pl-s1">i</span><span class="pl-c1">+</span><span class="pl-c1">1</span>])
    
    <span class="pl-k">return</span> [<span class="pl-s1">qml</span>.<span class="pl-c1">expval</span>(<span class="pl-s1">qml</span>.<span class="pl-c1">PauliZ</span>(<span class="pl-s1">i</span>)) <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-s1">n_qubits</span>)]

<span class="pl-c"># å®šä¹‰åŒ…å«PQCçš„PyTorchæ¨¡å‹</span>
<span class="pl-k">class</span> <span class="pl-c1">QCNN_PQC</span>(<span class="pl-s1">nn</span>.<span class="pl-c1">Module</span>):
    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">super</span>().<span class="pl-c1">__init__</span>()
        <span class="pl-c"># å…³é”®åŒºåˆ«ï¼šå°†é‡å­çº¿è·¯çš„æƒé‡æ³¨å†Œä¸ºPyTorchæ¨¡å‹å‚æ•°</span>
        <span class="pl-s1">self</span>.<span class="pl-c1">quantum_weights</span> <span class="pl-c1">=</span> <span class="pl-s1">nn</span>.<span class="pl-c1">Parameter</span>(<span class="pl-s1">torch</span>.<span class="pl-c1">randn</span>(<span class="pl-s1">quantum_weights_shape</span>))
        <span class="pl-s1">self</span>.<span class="pl-c1">classical_fc</span> <span class="pl-c1">=</span> <span class="pl-s1">nn</span>.<span class="pl-c1">Linear</span>(<span class="pl-s1">n_qubits</span>, <span class="pl-c1">1</span>)
        
    <span class="pl-k">def</span> <span class="pl-en">forward</span>(<span class="pl-s1">self</span>, <span class="pl-s1">x</span>):
        <span class="pl-c"># é‡å­éƒ¨åˆ†ï¼šPQCï¼Œå°†å¯è®­ç»ƒå‚æ•°quantum_weightsä¼ å…¥é‡å­èŠ‚ç‚¹</span>
        <span class="pl-c"># æ¯æ¬¡å‰å‘ä¼ æ’­éƒ½ä½¿ç”¨å½“å‰ä¼˜åŒ–å™¨æ›´æ–°åçš„æƒé‡å€¼</span>
        <span class="pl-s1">quantum_out</span> <span class="pl-c1">=</span> <span class="pl-s1">torch</span>.<span class="pl-c1">stack</span>([<span class="pl-en">pqc_quantum_conv</span>(<span class="pl-s1">x_i</span>, <span class="pl-s1">self</span>.<span class="pl-c1">quantum_weights</span>) <span class="pl-k">for</span> <span class="pl-s1">x_i</span> <span class="pl-c1">in</span> <span class="pl-s1">x</span>])
        <span class="pl-c"># ç»å…¸éƒ¨åˆ†</span>
        <span class="pl-s1">output</span> <span class="pl-c1">=</span> <span class="pl-s1">self</span>.<span class="pl-c1">classical_fc</span>(<span class="pl-s1">quantum_out</span>)
        <span class="pl-k">return</span> <span class="pl-s1">output</span></pre></div>
<blockquote>
<p>æœ€ç›´è§‚çš„åŒºåˆ«:é™æ€çº¿è·¯çš„å‚æ•°æ˜¯æ™®é€šTensorï¼Œè€ŒPQCçš„å‚æ•°æ˜¯nn.Parameterï¼Œè¿™ä¼šå‘Šè¯‰PyTorchè¿™äº›å€¼éœ€è¦åœ¨è®­ç»ƒä¸­è¢«ä¼˜åŒ–ã€‚</p>
</blockquote></div>
<div style="font-size:small;margin-top:8px;float:right;">è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">è¯„è®º</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright Â© <span id="copyrightYear"></span> <a href="https://Tundy-04.github.io/Tundy-04">Tundy's Blog</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if("01/12/2026"!=""){
    var startSite=new Date("01/12/2026");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="ç½‘ç«™è¿è¡Œ "+diffDay+" å¤©"+" â€¢ ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);



function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.disabled=true;
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","Tundy-04/Tundy-04");
    script.setAttribute("issue-term","title");
    
    if(localStorage.getItem("meek_theme")=="dark"){script.setAttribute("theme","dark-blue");}
    else if(localStorage.getItem("meek_theme")=="light") {script.setAttribute("theme","github-light");}
    else{script.setAttribute("theme","preferred-color-scheme");}
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>
<script src='https://blog.meekdai.com/Gmeek/plugins/GmeekTOC.js'></script><script src='https://blog.meekdai.com/Gmeek/plugins/lightbox.js'></script>

</html>
