# 量子线路 (Quantum Circuit)
## 1.逻辑门与电路
量子计算通过量子电路来实现。量子电路的本质是幺正变换和测量的组合。在物理上，我们无法直接实现过分复杂的幺正变换，所以期望通过一些容易实现的幺正变化来产生更复杂的幺正变换，这些较容易实现的变换则称为量子门。这个过程就类似于通过最基本的逻辑操作（与非门）来搭建大规模的数字电路一样。在本小节，我们将学习最基本的量子门，并简单了解一下如何通过她们来搭建复杂的量子电路。

### 1.1 经典逻辑门与电路
在了解量子电路之前我们可以先看一下经典计算是如何进行的。在本节中，我们介绍一种直观的经典计算模型，即电路模型。电路模型不只是一种数学模型，它也是真实计算机的实际物理实现方式。一个电路由导线和门组成，它们分别携带信息并执行简单的计算任务。例如，下图显示了一些简单的电路，他们只包含单个逻辑门进行逻辑上的非（NOT），与(AND)，或(OR) ，异或（XOR），NAND（与非）和或非（NOR）操作，称为量子门。输入和输出都只能是0（False）或者1(True)，称为经典比特（简称比特，和量子比特进行区分）。电路可以代表比特在空间中的运动，或者经过一段时间的状态变换。

<div align="center">

![Image](https://github.com/user-attachments/assets/f8c1ea2b-f9f0-4348-9592-0f95dc57cf47)

*经典逻辑门*

</div>
- 例: 给出一个稍微复杂点的电路，由两个逻辑门组成，称为半加器（half-adder）。我们可以验证以下输入输出关系：

```math
\begin{array}{l}
x=0, y=0 \rightarrow c=0, x \oplus y=0 \\
x=0, y=1 \rightarrow c=0, x \oplus y=1
\end{array}
```

而这正是两个比特相加的结果（包括进位比特）。这个电路称为半加器的原因是，其输入并没有包含进位比特。

<div align="center">

![Image](https://github.com/user-attachments/assets/ace40de5-639a-4837-989e-9093550824db)

*半加器电路，其中c是进位符*

</div>
我们可以发现，这里的“电路”是指代数字逻辑电路，与高中所学到的电阻、电源组成的电路有一定的区别。真实的计算机（包括电脑，手机等）通过使用高级语言的编程来实现算法功能。在计算机芯片层面，这些高级语言（Java, C, Python等）写的程序最终被转换（编译）成二进制数据，驱动CPU上一个个的逻辑门，并最终完成算法运算（本质是逻辑运算）。

更一般地，一个电路可以有很多输入和输出比特。任意一般的逻辑函数可以定义为
```math
f:\{0,1\}^n \to \{0,1\}^l
```
例如，半加器就是一个 $\\{ 0,1\\}^2$ 到 $\\{0,1\\}^2$ 的逻辑函数。

这里有一个重要的结论:

- (经典电路)普适性定理：任意逻辑函数，都可以由仅仅包含NAND门的电路来实现。我们称NAND门对经典逻辑计算是普适（universal）的。

由于篇幅限制，我们这里不给出相关的证明，有兴趣的读者可以参考任意一本数字逻辑电路的教科书。这个定理的意义在于，我们只需要实现一种类型的逻辑门，就能实现所有的逻辑电路，这将极大地简化理论分析和工程实现。

### 1.2 量子逻辑门与电路
与经典计算类似，在本节中，我们提供量子电路这种语言来描述量子计算过程的离散单元（量子门）的集合。对量子信息的处理本质上是一种幺正变换（配合额外的测量）。在我们考虑量子电路时，不失一般性，总是将测量放到整个计算过程的最后。这样，我们也可以仅将整个幺正变换看成是量子电路。这样，通用的量子计算过程可以如下图所示：
<div align="center">

![Image](https://github.com/user-attachments/assets/80d660d2-956e-436e-81dc-38c5b65eb230)

*量子计算过程*

</div>
接下来，我们将具体介绍不同类型的量子门，并演示他们如何组合成一些量子电路。

## 2.量子比特门
### 2.1单量子比特门

单量子比特门介绍

与经典逻辑门不同，量子电路对单个比特的操作要丰富得多。直觉地理解，经典比特对应 $|0\rangle$ 和 $|1\rangle$ 两个量子态，在Bloch球上分别是北极和南极，唯一能涉及的操作也就是在这两个点之间翻转（NOT门）。与之不同，单量子比特态却对应整个球面，我们可以通过变换连接球面上任意两个点。一些最重要的量子门包括泡利（Pauli）矩阵：

#### 泡利（Pauli）矩阵

```math
X = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix},\quad Y = \begin{pmatrix} 0 & -i \\ i & 0 \end{pmatrix},\quad Z = \begin{pmatrix} 1 & 0 \\ 0 & -1 \end{pmatrix}
```

要注意 $X$ ， $Y$ 和 $Z$ 这三个矩阵既是幺正的，又是厄米的。所以我们可以将他们看做量子门，也可以对他们进行测量。

- 作为量子门的作用：X 门、Y 门、Z 门是量子电路的 “基础逻辑门”，X 门对应经典的 “非门”，负责翻转量子比特状态；Z 门负责调控相位；

- 作为观测算子：测量量子比特在X、Y、Z方向的自旋，本质就是测量对应的泡利矩阵的本征值；

- 构建其他量子门：很多复杂单比特门可以用泡利矩阵的线性组合表示，以便理解具体的变换方式

另外三个在量子计算中极为重要的量子门包括:

```math
H = \frac{1}{\sqrt{2}} \begin{pmatrix} 1 & 1 \\ 1 & -1 \end{pmatrix},\quad S = \begin{pmatrix} 1 & 0 \\ 0 & i \end{pmatrix},\quad T = \begin{pmatrix} 1 & 0 \\ 0 & e^{i\pi/4} \end{pmatrix}
```

H、S、T门是单量子比特的三类相位与叠加调控门，均为幺正矩阵，是量子计算中构建叠加态、调控量子相位的核心工具，常与泡利门配合使用。

#### Hadamard门（H门）——叠加态构建门

H门是量子计算中最常用的门，核心作用是将量子比特从计算基（ $|0\rangle/|1\rangle$ ）转换到Hadamard基（ $|+\rangle/|-\rangle$ ），产生均匀叠加态。

矩阵形式：
```math
H = \frac{1}{\sqrt{2}}\begin{pmatrix}1 & 1 \\ 1 & -1\end{pmatrix}
```

从泡利矩阵角度， $H = \frac{1}{\sqrt{2}}(\sigma_{x} + \sigma_{z})$ ，完美体现了泡利矩阵的组合价值。

核心作用（态演化）：

- $H|0\rangle = \frac{1}{\sqrt{2}}(|0\rangle + |1\rangle) = |+\rangle$
- $H|1\rangle = \frac{1}{\sqrt{2}}(|0\rangle - |1\rangle) = |-\rangle$
- $H|+\rangle = |0\rangle$， $H|-\rangle = |1\rangle$ → H门也是自逆门（ $H^2 = I$ ）

物理意义：

在Bloch球上，H门等价于绕y轴旋转 $\frac{\pi}{2}$ 角，将z轴的极点（ $|0\rangle/|1\rangle$ ）转到x轴的极点（ $|+\rangle/|-\rangle$ ）。

QCNN中的应用：

H门是量子特征提取的起点，通过将量子比特置于叠加态，让量子卷积核能同时作用于多个基态，提取更丰富的量子关联特征。

#### Phase门（S门）——π/2相位门

S门是相位调控门，核心作用是对 $|1\rangle$ 态引入 $\pi/2$ （90°）的相位翻转，不改变量子比特的测量概率，只改变相位。

矩阵形式：

```math
S = \begin{pmatrix}1 & 0 \\ 0 & i\end{pmatrix}
```

其中 $i = e^{i\pi/2}$ ，对应相位因子。

核心作用（态演化）：

- $S|0\rangle = |0\rangle$
- $S|1\rangle = i|1\rangle = e^{i\pi/2}|1\rangle$
- S门不是自逆门，其逆门为 
```math
S^{\dagger} = \begin{pmatrix}1 & 0 \\ 0 & -i\end{pmatrix}（共轭转置）,满足 S \cdot S^{\dagger} = I
```

物理意义：

在Bloch球上，S门等价于绕z轴旋转 $\pi/2$ 角，只改变量子态的相位，不改变其在z轴上的投影。

#### π/8门（T门）——π/4相位门

T门是S门的“细分版”，核心作用是对 $|1\rangle$ 态引入 $\pi/4$ （45°）的相位翻转，是量子计算中实现任意相位旋转的基础门（与H门、S门共同构成单比特门的通用集）。

矩阵形式：

```math
T = \begin{pmatrix}1 & 0 \\ 0 & e^{i\pi/4}\end{pmatrix} = \begin{pmatrix}1 & 0 \\ 0 & \frac{\sqrt{2}}{2} + i\frac{\sqrt{2}}{2}\end{pmatrix}
```
核心作用（态演化）：

- $T|0\rangle = |0\rangle$
- $T|1\rangle = e^{i\pi/4}|1\rangle$
- 逆门为 
```math
T^{\dagger} = \begin{pmatrix}1 & 0 \\ 0 & e^{-i\pi/4}\end{pmatrix} ,且T^{8} = I（连续施加8次等价于单位操作）
```
物理意义：

在Bloch球上，T门等价于绕z轴旋转 $\pi/4$ 角，是实现高精度相位调控的核心组件。

> [!NOTE]
> 为什么绕Z轴旋转？
> 量子→经典中的测量是测量Z轴上的投影，绕Z旋转可以在不改变概率的情况下改变相位，改变相位在组合其他门时有特殊的算法意义。

---

为了更深入地理解单量子比特门，我们可以用泡利矩阵定义如下三个幺正矩阵：

```math
R_x(\theta) = \cos(\theta/2)I - i\sin(\theta/2)X = \begin{pmatrix} \cos(\theta/2) & -i\sin(\theta/2) \\ -i\sin(\theta/2) & \cos(\theta/2) \end{pmatrix},
```

```math
R_y(\theta) = \cos(\theta/2)I - i\sin(\theta/2)Y = \begin{pmatrix} \cos(\theta/2) & -\sin(\theta/2) \\ \sin(\theta/2) & \cos(\theta/2) \end{pmatrix},
```

```math
R_z(\theta) = \cos(\theta/2)I - i\sin(\theta/2)Z = \begin{pmatrix} e^{-i\theta/2} & 0 \\ 0 & e^{i\theta/2} \end{pmatrix}.
```

这三个矩阵分别称为绕Bloch球上的 $x,y,z$ 轴顺时针旋转 $\theta$ 角。我们以 $R_z$ 为例：

```math
R_z(\alpha)\big(\cos(\theta/2)|0\rangle + \sin(\theta/2)e^{i\varphi}|1\rangle\big) \cong \cos(\theta/2)|0\rangle + \sin(\theta/2)e^{i(\varphi+\theta)}|1\rangle
```

而这正是量子态在Bloch球上绕着Z轴顺时针旋转了 $\theta$ 。 $R_x$ ， $R_y$ 的验证要复杂些，我们这边不做展开。除了 $x,y,z$ 轴的旋转外，我们也可以找到绕任意单位向量 $\hat{n}=(n_x,n_y,n_z)$ 旋转的单量子比特门：

```math
R_{\hat{n}}(\theta) = \cos(\theta/2)I + i\sin(\theta/2)\big(n_xX + n_yY + n_zZ\big)
```
事实上，任意单量子比特门都可以看成是绕某根特定轴 $\hat{n}$ 的旋转，满足：

```math
U_1 \cong R_{\hat{n}}(\theta),
```
其中 $\theta$ ， $\hat{n}$ 完全由 $U_1$ 决定。


如果我们只能进行绕固定轴的旋转，我们仍然可以实现任意单量子比特门的幺正变化。这里我们有以下非常有用的定理：

**定理**：任意作用在单量子比特上的幺正操作 $U_1$ ，都可以分解为绕任意2根固定的互相垂直的轴的旋转。以 $y$ 轴和 $z$ 轴为例，我们有：

```math
U_1 \cong R_z(\beta) R_y(\gamma) R_z(\delta),
```

其中 $\beta , \gamma , \delta$ 由 $U_1$ 决定。
